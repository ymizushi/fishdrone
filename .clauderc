# Claude Code カスタム設定 - Fishdrone プロジェクト

このプロジェクトは、ハードウェア設計とマイコンプログラミングを統合した開発環境です。

## プロジェクト構成

- **Fusion 360**: 3D CAD設計（機械設計）
- **KiCad**: 電子回路基板設計（PCB/回路図）
- **マイコンプログラム**: 組み込みソフトウェア開発

## コーディング規約・設計指針

### マイコンプログラム開発

#### 基本方針
- リソース制約を常に意識する（メモリ、処理速度、消費電力）
- リアルタイム性が求められる処理を優先
- デバッグ困難なため、preventive（予防的）なコーディングを重視

#### コードスタイル
- 変数名は意味が明確に分かるように命名
- マジックナンバーは避け、定数として定義
- メモリアロケーションは静的に行う（動的メモリ確保は最小限に）
- グローバル変数の使用は最小限にし、使用する場合は明示的にコメント

#### 安全性・信頼性
- オーバーフロー、アンダーフローのチェック
- ウォッチドッグタイマーの適切な使用
- 割り込み処理は最小限の処理のみ
- クリティカルセクションの保護

#### ドキュメント
- 各関数にコメントで目的、引数、戻り値を記載
- ハードウェア依存部分は明示的にコメント
- タイミング制約がある処理は必ず記載

### KiCad 設計

#### ファイル管理
- プロジェクトファイル（.kicad_pro）、回路図（.kicad_sch）、基板（.kicad_pcb）を適切にバージョン管理
- ライブラリファイルの変更は慎重に扱う
- ガーバーファイルは生成時のタイムスタンプをディレクトリ名に含める

#### 設計ルール
- 部品配置の意図（熱、ノイズ、干渉）をコメントや設計ノートに記載
- 電源ラインとグランドプレーンの設計は重点的に確認
- 外部接続端子のピン配置は誤接続を防ぐ配慮

### Fusion 360 設計

#### ファイル管理
- エクスポートファイル（STEP、STL等）はバージョン管理
- Fusion 360のクラウドプロジェクト名とローカルディレクトリの対応を明確に
- アセンブリと個別部品の関係を整理

#### 設計ルール
- 製造方法（3Dプリント、切削加工等）を考慮した設計
- 組み立て時の手順を意識した設計
- 電子部品や基板の取り付けスペースを確保
- 配線経路を確保

## 開発時の注意事項

### クロスドメインの整合性
- 機械設計（Fusion 360）と電子設計（KiCad）と制御ソフトウェア（マイコン）の寸法、接続仕様を常に確認
- インターフェース仕様の変更は3つのドメイン全てに影響することを意識
- バージョン管理時は関連する全ファイルをセットでコミット

### ドキュメント
- 各設計変更の理由と影響範囲を記録
- ハードウェアとソフトウェアのバージョン対応表を維持
- テスト結果と問題点を記録

### Git運用
- バイナリファイル（Fusion 360ファイル等）は慎重に扱う
- 大きなファイルはGit LFSの使用を検討
- コミットメッセージには変更したドメイン（機械/電子/ソフトウェア）を明記

## コード変更時の確認事項

- [ ] ハードウェア仕様との整合性
- [ ] リソース使用量（メモリ、CPU）
- [ ] リアルタイム性への影響
- [ ] 他のモジュールへの影響
- [ ] テスト方法の明確化
